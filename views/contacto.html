<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Masters PC</title>
    <link rel="stylesheet" href="../estilos/estilos.css">
    <script async
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7TrDDEgN7luyLGeY-TynTnLwCj-cnzEk&callback=initMap"
        defer></script>
    <script>
        let map, directionsService, directionsRenderer;

        function cargarmapa() {
            const punto = new google.maps.LatLng(40.0964469909668, -4.12019157409668);
            // Creación del punto de coordenadas
            const opciones = {
                zoom: 14,
                center: punto,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            // Creación del mapa
            map = new google.maps.Map(document.getElementById("mapa"), opciones);

            // Inicializar el servicio de direcciones
            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer();
            directionsRenderer.setMap(map);

            // Crear el marcador
            const marker = new google.maps.Marker({
                position: punto,
                map: map,
                title: "Mi marca"
            });

            // Añadir evento de clic al marcador
            marker.addListener('click', () => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            const userLocation = {
                                lat: position.coords.latitude,
                                lng: position.coords.longitude,
                            };
                            calculateAndDisplayRoute(userLocation, punto);
                        },
                        () => {
                            handleLocationError(true, map.getCenter());
                        }
                    );
                } else {
                    handleLocationError(false, map.getCenter());
                }
            });
        }

        function calculateAndDisplayRoute(userLocation, businessLocation) {
            directionsService.route(
                {
                    origin: userLocation,
                    destination: businessLocation,
                    travelMode: google.maps.TravelMode.DRIVING,
                },
                (response, status) => {
                    if (status === 'OK') {
                        directionsRenderer.setDirections(response);
                    } else {
                        window.alert('Directions request failed due to ' + status);
                    }
                }
            );
        }

        function handleLocationError(browserHasGeolocation, pos) {
            const infoWindow = new google.maps.InfoWindow({
                position: pos,
                content: browserHasGeolocation
                    ? 'Error: El servicio de geolocalización falló.'
                    : 'Error: Tu navegador no soporta geolocalización.',
            });
            infoWindow.open(map);
        }
    </script>
</head>

<body onload="cargarmapa()">
    <div class="contenedor">
        <header>
            <!--En vez de colocar un botón inicio, utilizo el logo de la tienda para volver a la página principal-->
            <a href="../index.html"><img id="foto" alt="logo_masters_pc" src="../assets/image/Logonuevo.png" width="500" height="500"></a>
            <nav>
                <!--Aquí coloco los enlaces al resto de páginas-->
                <a href="../views/productos.html" class="nav-enlace">Galería</a>
                <a href="../views/presupuesto.html" class="nav-enlace">Presupuesto</a>
                <a href="#" class="nav-enlace" id="coloractual">Contacto</a>
            </nav>
        </header>
        <main>
        <div class="acerca">
            <div class="caja1">
        <h1>Contacto</h1>
        <div>
            <p><strong>Nombre del Negocio:</strong> Masters Pc</p>
            <p><strong>Dirección:</strong> Calle Italia 41, Camarena, España</p>
            <p><strong>Teléfono:</strong> 636167680</p>
            <p><strong>Email:</strong> masterspc@gmail.com</p>
        </div>
    </div>
    </div>
        <div id="mapa"></div>
    </main>
    </div>
    <footer>
        <div id="footer">
            <div class="redes-sociales">
                <a href="https://www.facebook.com/?locale=es_ES"><img src="../assets/image/facebook.png" class="red"
                        alt="facebook" width="512" height="512"></a>
                <a href="https://www.instagram.com/"><img src="../assets/image/instagram.png" class="red"
                        alt="instagram" width="512" height="512"></a>
                <a href="https://twitter.com/"><img src="../assets/image/gorjeo.png" class="red" alt="twitter" width="512" height="512"></a>
            </div>

            <div id="avisolegal">
                <a href="../views/avisolegal.html">Aviso legal</a>

            </div>
        </div>
    </footer>
</body>

</html>
